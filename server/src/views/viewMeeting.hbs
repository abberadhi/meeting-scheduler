
<div style="margin-top: 5em;" class="container">

  <div class="row">
    <div class="col-md-9">

      <h4>{{meeting.details.[0].title}}</h4>
      <hr>
        <p class="align-items-right text-right">Created: {{readableDate meeting.details.[0].creation_date}}</p>
        <div class="row">
      <div class="col-md-4">
        <h5>Details:</h5>
        <p><i class="fas fa-clock"></i> <b>{{finalDate meeting.pollChoices}}</b></p>
        <p><i class="fas fa-map-marker-alt"></i> {{meeting.details.[0].location}}</p>
        <p><i class="fas fa-scroll"></i> {{meeting.details.[0].description}}</p>
      </div>
      <div class="col-md-8">
    <div class="col-md-4"></div>
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title"><span class="fa fa-poll"></span> Attendance date & time</h3>
            </div>
            <form method="POST">
              <div class="panel-body">
                {{#each meeting.pollChoices}}
                <div class="box">
                  <input value="{{this.id}}" name="time" id="{{this.id}}" type="checkbox" {{#if (hasVoted this.votes ../user.displayName)}}checked{{/if}}>
                  <span class="check"></span>
                  <label for="{{this.id}}">{{eventDate this.meeting_date_start}} ({{time24 this.meeting_date_start}} - {{time24 this.meeting_date_end}})</label>
                  <p data-toggle="tooltip" data-placement="right" data-html="true"  title="{{joinAttendees this.votes}}"><i class="fas fa-user"></i> +{{lengthArray this.votes}}</p>
                </div>
                {{/each}}
              </div>
              <div class="panel-footer text-center">
                  <button type="submit" name="vote" value="1" class="btn btn-primary btn-block btn-sm">
                      Vote</button>
                  <a href="#" class="small">None of these times fit me</a>
              </div>
            </form>
        </div>
      </div>
      </div>
    </div>
    <div class="col-md-3">

      <h5>Attendees: 
        {{#if (ifEquals meeting.details.[0].organizer_id user.oid)}} 
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addUser"><i class="fas fa-user-plus"></i></button> 
        {{/if}}</h5>

      {{#each meeting.attendees}}
      <div style="margin-bottom: 2em;" class="attendees-list">
        
        <p>{{#if this.picture}}<img src="/{{ this.picture }}" class="rounded-circle align-self-center mr-2" style="width: 32px; border: 1px solid grey;">{{else}}
        <i class="far fa-user-circle fa-lg rounded-circle align-self-center mr-2" style="font-size: 30px;"></i>
        {{/if}}
        {{this.displayName}} 
        {{#if (ifEquals this.user_id ../meeting.details.[0].organizer_id)}}
        <i class="fas fa-crown" data-toggle="tooltip" data-placement="top" title="Organizer"></i>
        {{/if}}
        {{#if this.seen}}
        <i class="fas fa-eye" data-toggle="tooltip" data-placement="top" title="Seen"></i>
        {{/if}}
        </p>
        <p style="font-size: 0.8em; margin-top: -1em;">{{this.email}}</p>  
      </div>
      {{/each}}
    </div>
  </div>
</div>


<!-- Add user Modal -->
<div class="modal fade" id="addUser" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form method="POST">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"><i class="fas fa-user"></i> Add attende</h5>
        <button type="submit" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="exampleInputEmail1">Email address</label>
          <input type="email" name="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="submit" name="addUser" value="1" class="btn btn-primary">Add</button>
      </div>
      </form>
    </div>
  </div>
</div>

<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>